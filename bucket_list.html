<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Global Bucket List</title>
    <style>
      * {
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background-color: #f7f7f7;
        color: #333;
        line-height: 1.6;
        padding: 20px;
      }

      h1 {
        text-align: center;
        margin-bottom: 1rem;
        font-size: 2.5rem;
        color: #333;
      }

      p {
        text-align: center;
        margin-bottom: 2rem;
        font-size: 1.1rem;
        color: #666;
      }

      .main-content {
        display: flex;
        justify-content: space-between;
        margin-left: 200px; /* Shift the main content to the right of the sidebar */
        width: calc(100% - 200px);
      }

      .country-button {
        display: block;
        width: 200px;
        margin: 20px auto;
        padding: 15px;
        background: #0056b3;
        border: none;
        color: #fff;
        text-align: center;
        font-size: 18px;
        cursor: pointer;
        transition: background-color 0.3s ease;
        border-radius: 20px;
        text-transform: uppercase;
        font-weight: 600;
        box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
        background-size: contain;
        background-position: center;
        background-repeat: no-repeat;
      }

      .country-button:hover {
        background-color: #003d82;
      }

      /* Style for the country container */
      .country-container,
      .continent-container {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        gap: 1px 0;
        margin-right: 20px;
        order: 1;
        flex-grow: 0; /* Prevents the container from growing */

        /* Background properties */
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;

        /* Width settings */
        min-width: 450px; /* Adjusted minimum width */
      }

      #map {
        order: 2; /* Ensure this appears second */
        width: 50%; /* Adjust the width as per your requirement */
        height: 400px; /* Adjust the height as per your requirement */
      }

      .bucket-list-button {
        display: block; /* Make buttons block-level for full-width */
        width: calc(100% - 30px); /* Full width accounting for padding */
        padding: 15px 15px 15px 15px; /* Uniform padding on all sides */
        margin: 5px 0; /* Minimal vertical space between buttons */
        border-radius: 5px;
        cursor: pointer;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        font-weight: bold;
        text-align: left; /* Align text to the left */
        border: none;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        background-size: 100% 1000%; /* Size adjusted for the number of items */
        height: 50px; /* Adjust the height as needed */
        overflow: hidden;
        position: relative;
        color: #0000ff; /* Vibrant blue color for text */
        text-shadow: -1px -1px 0 #fff, 1px -1px 0 #fff, -1px 1px 0 #fff,
          1px 1px 0 #fff; /* White outline effect */

        font-weight: 900; /* Maximum boldness */
      }

      .bucket-list-button:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
      }

      .bucket-list-button::after {
        content: attr(data-text); /* Use a data attribute for the text */
        position: absolute;
        left: 15px;
        bottom: 10px;
        background: rgba(
          255,
          255,
          255,
          0.5
        ); /* Semi-transparent white background */
        color: #0000ff;
        padding: 5px;
        border-radius: 5px;
      }

      .dropdown-content {
        display: none; /* Initially hidden */
        background-color: #f9f9f9; /* Light background for the content */
        border: 1px solid #ddd; /* A subtle border */
        border-radius: 4px; /* Rounded corners */
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1); /* A light shadow for depth */
        padding: 10px; /* Some padding for internal spacing */
        margin-top: 5px; /* Space between the button and dropdown */
        width: 250px; /* Width of the dropdown */
        z-index: 1; /* Ensures dropdown is on top of other elements */
      }

      .dropdown-content p {
        margin: 0 0 10px; /* Space between paragraphs */
        line-height: 1.4; /* Line height for readability */
        color: #333; /* Dark color for text for better contrast */
      }

      .bucket-list-button:hover,
      .bucket-list-button:focus {
        background-color: #e7e7e7; /* Slightly darker on hover */
        cursor: pointer; /* Change cursor to indicate clickability */
      }

      /* Add more categories with unique gradients here */

      .default-category {
        background-color: #95a5a6; /* Default grey */
      }

      .bucket-list-button span {
        display: block;
        margin: 5px 0;
      }
      /* New styles for side panel with buttons */
      .sidebar {
        position: fixed; /* Fixed sidebar (stay in place on scroll) */
        left: 0;
        top: 0;
        width: 200px; /* Set the width of the sidebar */
        height: 100%; /* Full-height sidebar */
        padding: 20px 10px;
        background-color: #f1f1f1;
        overflow-x: hidden; /* Disable horizontal scroll */
      }

      /* Style for the buttons in the sidebar */
      .sidebar .country-button {
        display: block;
        width: 100%;
        margin: 10px 0;
        box-shadow: none;
        border-radius: 0;
        background-size: cover;
        background-position: center;
        color: white; /* Assuming white text */
        font-size: 18px; /* Adjust as needed */
        font-weight: bold; /* Bold text for better visibility */
        text-align: center; /* Center the text */
        padding: 15px 0; /* Add some padding */
        text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000,
          1px 1px 0 #000; /* Text outline effect */
        transition: all 0.3s ease; /* Smooth transition for hover effects */
      }

      .country-button:hover {
        background-color: rgba(
          255,
          255,
          255,
          0.2
        ); /* Slight highlight on hover */
        color: #000; /* Change text color on hover */
        text-shadow: none; /* Remove text shadow on hover for a different effect */
      }

      button {
        padding: 10px 20px;
        border: none;
        border-radius: 20px;
        cursor: pointer;
        background-color: #f8f8f8;
        color: #333;
        font-size: 14px;
        font-weight: 600;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        transition: all 0.3s ease;
        position: relative; /* Position relative to allow absolute positioning inside */
        overflow: visible; /* Let the ::after content overflow */
      }

      button:hover {
        background-color: #e2e2e2;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        transform: translateY(-2px);
      }

      .continent-button {
        display: block;
        width: 100%;
        padding: 20px;
        margin-bottom: 10px;
        background: url("assets/images/flags/europe_flag.png") no-repeat center
            center,
          linear-gradient(to bottom, rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.3));
        background-size: cover;
        color: white;
        border: none;
        text-align: center;
        cursor: pointer;
        border-radius: 5px;
        font-size: 20px;
        font-weight: 700;
        text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000,
          1px 1px 0 #000; /* Creating an outline effect */
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      }

      .continent-button:hover {
        background-color: #3e8e41; /* This will affect the color overlay on hover */
      }
    </style>
  </head>
  <body>
    <!-- Sidebar with country buttons -->

    <div class="sidebar">
      <!-- Global button -->
      <button
        class="continent-button"
        onclick="toggleLocation('Global')"
        style="background-image: url('assets/images/flags/global_flag.png')"
      >
        Global
      </button>

      <!-- Africa button -->
      <button
        class="continent-button"
        onclick="toggleLocation('Africa')"
        style="background-image: url('assets/images/flags/africa_flag.png')"
      >
        Africa
      </button>

      <!-- Asia button -->
      <button
        class="continent-button"
        onclick="toggleContinent('Asia')"
        style="background-image: url('assets/images/flags/asia_flag.png')"
      >
        Asia
      </button>

      <!-- Americas button -->
      <button
        class="continent-button"
        onclick="toggleContinent('Americas')"
        style="background-image: url('assets/images/flags/americas_flag.png')"
      >
        Americas
      </button>

      <!-- Europe button -->
      <button
        class="continent-button"
        onclick="toggleContinent('Europe')"
        style="background-image: url('assets/images/flags/europe_flag.png')"
      >
        Europe
      </button>

      <!-- Europe country buttons, initially hidden -->
      <div
        id="Europe-country-buttons"
        class="country-buttons"
        style="display: block; overflow-y: auto; max-height: 300px"
      >
        <button
          class="country-button"
          onclick="toggleCountry('France')"
          style="background-image: url('assets/images/flags/france_flag.png')"
        >
          France
        </button>

        <button
          class="country-button"
          onclick="toggleCountry('Italy')"
          style="background-image: url('assets/images/flags/italy_flag.png')"
        >
          Italy
        </button>
        <button
          class="country-button"
          onclick="toggleCountry('Spain')"
          style="background-image: url('assets/images/flags/spain_flag.png')"
        >
          Spain
        </button>
        <button
          class="country-button"
          onclick="toggleCountry('Germany')"
          style="background-image: url('assets/images/flags/germany_flag.png')"
        >
          Germany
        </button>
        <button
          class="country-button"
          onclick="toggleCountry('Albania')"
          style="background-image: url('assets/images/flags/albania_flag.png')"
        >
          Albania
        </button>

        <button
          class="country-button"
          onclick="toggleCountry('Andorra')"
          style="background-image: url('assets/images/flags/andorra_flag.png')"
        >
          Andorra
        </button>

        <button
          class="country-button"
          onclick="toggleCountry('Armenia')"
          style="background-image: url('assets/images/flags/armenia_flag.png')"
        >
          Armenia
        </button>

        <button
          class="country-button"
          onclick="toggleCountry('Azerbaijan')"
          style="
            background-image: url('assets/images/flags/azerbaijan_flag.png');
          "
        >
          Azerbaijan
        </button>

        <button
          class="country-button"
          onclick="toggleCountry('Belarus')"
          style="background-image: url('assets/images/flags/belarus_flag.png')"
        >
          Belarus
        </button>

        <button
          class="country-button"
          onclick="toggleCountry('Belgium')"
          style="background-image: url('assets/images/flags/belgium_flag.png')"
        >
          Belgium
        </button>

        <button
          class="country-button"
          onclick="toggleCountry('Bosnia')"
          style="background-image: url('assets/images/flags/bosnia_flag.png')"
        >
          Bosnia
        </button>

        <button
          class="country-button"
          onclick="toggleCountry('Bulgaria')"
          style="background-image: url('assets/images/flags/bulgaria_flag.png')"
        >
          Bulgaria
        </button>

        <button
          class="country-button"
          onclick="toggleCountry('Cyprus')"
          style="background-image: url('assets/images/flags/cyprus_flag.png')"
        >
          Cyprus
        </button>

        <button
          class="country-button"
          onclick="toggleCountry('Czech')"
          style="
            background-image: url('assets/images/flags/czech_republic_flag.png');
          "
        >
          Czech Republic
        </button>

        <button
          class="country-button"
          onclick="toggleCountry('Croatia')"
          style="background-image: url('assets/images/flags/croatia_flag.png')"
        >
          Croatia
        </button>

        <button
          class="country-button"
          onclick="toggleCountry('Denmark')"
          style="background-image: url('assets/images/flags/denmark_flag.png')"
        >
          Denmark
        </button>

        <button
          class="country-button"
          onclick="toggleCountry('Finland')"
          style="background-image: url('assets/images/flags/finland_flag.png')"
        >
          Finland
        </button>

        <button
          class="country-button"
          onclick="toggleCountry('Estonia')"
          style="background-image: url('assets/images/flags/estonia_flag.png')"
        >
          Estonia
        </button>

        <button
          class="country-button"
          onclick="toggleCountry('Georgia')"
          style="background-image: url('assets/images/flags/georgia_flag.png')"
        >
          Georgia
        </button>

        <button
          class="country-button"
          onclick="toggleCountry('Greece')"
          style="background-image: url('assets/images/flags/greece_flag.png')"
        >
          Greece
        </button>

        <button
          class="country-button"
          onclick="toggleCountry('Hungary')"
          style="background-image: url('assets/images/flags/hungary_flag.png')"
        >
          Hungary
        </button>

        <button
          class="country-button"
          onclick="toggleCountry('Iceland')"
          style="background-image: url('assets/images/flags/iceland_flag.png')"
        >
          Iceland
        </button>

        <button
          class="country-button"
          onclick="toggleCountry('Ireland')"
          style="background-image: url('assets/images/flags/ireland_flag.png')"
        >
          Ireland
        </button>

        <button
          class="country-button"
          onclick="toggleCountry('Kazakhstan')"
          style="
            background-image: url('assets/images/flags/kazakhstan_flag.png');
          "
        >
          Kazakhstan
        </button>

        <button
          class="country-button"
          onclick="toggleCountry('Kosovo')"
          style="background-image: url('assets/images/flags/kosovo_flag.png')"
        >
          Kosovo
        </button>

        <button
          class="country-button"
          onclick="toggleCountry('Latvia')"
          style="background-image: url('assets/images/flags/latvia_flag.png')"
        >
          Latvia
        </button>

        <button
          class="country-button"
          onclick="toggleCountry('Liechtenstein')"
          style="
            background-image: url('assets/images/flags/liechtenstein_flag.png');
          "
        >
          Liechtenstein
        </button>

        <button
          class="country-button"
          onclick="toggleCountry('Luxembourg')"
          style="
            background-image: url('assets/images/flags/luxembourg_flag.png');
          "
        >
          Luxembourg
        </button>

        <button
          class="country-button"
          onclick="toggleCountry('Malta')"
          style="background-image: url('assets/images/flags/malta_flag.png')"
        >
          Malta
        </button>

        <button
          class="country-button"
          onclick="toggleCountry('Moldova')"
          style="background-image: url('assets/images/flags/moldova_flag.png')"
        >
          Moldova
        </button>

        <button
          class="country-button"
          onclick="toggleCountry('Monaco')"
          style="background-image: url('assets/images/flags/monaco_flag.png')"
        >
          Monaco
        </button>

        <button
          class="country-button"
          onclick="toggleCountry('Montenegro')"
          style="
            background-image: url('assets/images/flags/montenegro_flag.png');
          "
        >
          Montenegro
        </button>

        <button
          class="country-button"
          onclick="toggleCountry('NorthMacedonia')"
          style="
            background-image: url('assets/images/flags/north_macedonia_flag.png');
          "
        >
          North Macedonia
        </button>

        <button
          class="country-button"
          onclick="toggleCountry('Poland')"
          style="background-image: url('assets/images/flags/poland_flag.png')"
        >
          Poland
        </button>

        <button
          class="country-button"
          onclick="toggleCountry('Romania')"
          style="background-image: url('assets/images/flags/romania_flag.png')"
        >
          Romania
        </button>

        <button
          class="country-button"
          onclick="toggleCountry('Netherlands')"
          style="
            background-image: url('assets/images/flags/netherlands_flag.png');
          "
        >
          Netherlands
        </button>

        <button
          class="country-button"
          onclick="toggleCountry('Norway')"
          style="background-image: url('assets/images/flags/norway_flag.png')"
        >
          Norway
        </button>

        <button
          class="country-button"
          onclick="toggleCountry('Portugal')"
          style="background-image: url('assets/images/flags/portugal_flag.png')"
        >
          Portugal
        </button>

        <button
          class="country-button"
          onclick="toggleCountry('Sweden')"
          style="background-image: url('assets/images/flags/sweden_flag.png')"
        >
          Sweden
        </button>

        <button
          class="country-button"
          onclick="toggleCountry('Switzerland')"
          style="
            background-image: url('assets/images/flags/switzerland_flag.png');
          "
        >
          Switzerland
        </button>

        <button
          class="country-button"
          onclick="toggleCountry('SanMarino')"
          style="
            background-image: url('assets/images/flags/san_marino_flag.png');
          "
        >
          San Marino
        </button>

        <button
          class="country-button"
          onclick="toggleCountry('Serbia')"
          style="background-image: url('assets/images/flags/serbia_flag.png')"
        >
          Serbia
        </button>

        <button
          class="country-button"
          onclick="toggleCountry('Slovakia')"
          style="background-image: url('assets/images/flags/slovakia_flag.png')"
        >
          Slovakia
        </button>

        <button
          class="country-button"
          onclick="toggleCountry('Slovenia')"
          style="background-image: url('assets/images/flags/slovenia_flag.png')"
        >
          Slovenia
        </button>

        <button
          class="country-button"
          onclick="toggleCountry('Turkey')"
          style="background-image: url('assets/images/flags/turkey_flag.png')"
        >
          Turkey
        </button>

        <button
          class="country-button"
          onclick="toggleCountry('UnitedKingdom')"
          style="
            background-image: url('assets/images/flags/united_kingdom_flag.png');
          "
        >
          United Kingdom
        </button>

        <button
          class="country-button"
          onclick="toggleCountry('Ukraine')"
          style="background-image: url('assets/images/flags/ukraine_flag.png')"
        >
          Ukraine
        </button>

        <button
          class="country-button"
          onclick="toggleCountry('Vatican')"
          style="background-image: url('assets/images/flags/vatican_flag.png')"
        >
          Vatican
        </button>

        <!-- Add more buttons as needed -->
      </div>
      <!-- Latin America button -->
      <button
        class="continent-button"
        onclick="toggleContinent('LatinAmerica')"
        style="
          background-image: url('assets/images/flags/latin_america_flag.png');
        "
      >
        Latin America
      </button>

      <div id="LatinAmerica-country-buttons" style="display: none">
        <!-- Add buttons for Latin American countries here -->
        <button
          class="country-button"
          onclick="toggleCountry('Brazil')"
          style="background-image: url('assets/images/flags/brazil_flag.png')"
        >
          Brazil
        </button>
        <button
          class="country-button"
          onclick="toggleCountry('Argentina')"
          style="
            background-image: url('assets/images/flags/argentina_flag.png');
          "
        >
          Argentina
        </button>
        <button
          class="country-button"
          onclick="toggleCountry('Peru')"
          style="background-image: url('assets/images/flags/peru_flag.png')"
        >
          Peru
        </button>
      </div>
      <!-- Pacific button -->
      <button
        class="continent-button"
        onclick="toggleContinent('Pacific')"
        style="background-image: url('assets/images/flags/pacific_flag.png')"
      >
        Pacific
      </button>
    </div>

    <!-- Main content area where the country's bucket list and map will be displayed -->
    <div class="main-content">
      <h1></h1>

      <!-- Content containers for each continent's bucket list -->
      <div id="Global" class="continent-container" style="display: none"></div>
      <div id="Africa" class="continent-container" style="display: none"></div>
      <div
        id="Americas"
        class="continent-container"
        style="display: none"
      ></div>
      <div id="Asia" class="continent-container" style="display: none"></div>
      <div id="Europe" class="continent-container" style="display: none"></div>
      <div
        id="Latin America"
        class="continent-container"
        style="display: none"
      ></div>

      <!-- Content containers for each country's bucket list -->
      <div id="country-divs-container">
        <div id="Albania" class="country-container" style="display: none"></div>
        <div id="Andorra" class="country-container" style="display: none"></div>
        <div id="Austria" class="country-container" style="display: none"></div>
        <div id="Armenia" class="country-container" style="display: none"></div>
        <div
          id="Azerbaijan"
          class="country-container"
          style="display: none"
        ></div>
        <div id="Belarus" class="country-container" style="display: none"></div>
        <div id="Belgium" class="country-container" style="display: none"></div>
        <div id="Bosnia" class="country-container" style="display: none"></div>
        <div
          id="Bulgaria"
          class="country-container"
          style="display: none"
        ></div>
        <div id="Croatia" class="country-container" style="display: none"></div>
        <div id="Cyprus" class="country-container" style="display: none"></div>
        <div id="Czech" class="country-container" style="display: none"></div>
        <div id="Denmark" class="country-container" style="display: none"></div>
        <div id="Estonia" class="country-container" style="display: none"></div>
        <div id="Finland" class="country-container" style="display: none"></div>
        <div id="France" class="country-container" style="display: none"></div>
        <div id="Georgia" class="country-container" style="display: none"></div>
        <div id="Germany" class="country-container" style="display: none"></div>
        <div id="Greece" class="country-container" style="display: none"></div>
        <div id="Hungary" class="country-container" style="display: none"></div>
        <div id="Iceland" class="country-container" style="display: none"></div>
        <div id="Ireland" class="country-container" style="display: none"></div>
        <div id="Italy" class="country-container" style="display: none"></div>
        <div
          id="Kazakhstan"
          class="country-container"
          style="display: none"
        ></div>
        <div id="Kosovo" class="country-container" style="display: none"></div>
        <div id="Latvia" class="country-container" style="display: none"></div>
        <div
          id="Liechtenstein"
          class="country-container"
          style="display: none"
        ></div>
        <div
          id="Lithuania"
          class="country-container"
          style="display: none"
        ></div>
        <div
          id="Luxembourg"
          class="country-container"
          style="display: none"
        ></div>
        <div id="Malta" class="country-container" style="display: none"></div>
        <div id="Moldova" class="country-container" style="display: none"></div>
        <div id="Monaco" class="country-container" style="display: none"></div>
        <div
          id="Montenegro"
          class="country-container"
          style="display: none"
        ></div>
        <div
          id="Netherlands"
          class="country-container"
          style="display: none"
        ></div>
        <div
          id="NorthMacedonia"
          class="country-container"
          style="display: none"
        ></div>
        <div id="Norway" class="country-container" style="display: none"></div>
        <div id="Poland" class="country-container" style="display: none"></div>
        <div
          id="Portugal"
          class="country-container"
          style="display: none"
        ></div>
        <div id="Romania" class="country-container" style="display: none"></div>
        <div id="Russia" class="country-container" style="display: none"></div>
        <div
          id="SanMarino"
          class="country-container"
          style="display: none"
        ></div>
        <div id="Serbia" class="country-container" style="display: none"></div>
        <div
          id="Slovakia"
          class="country-container"
          style="display: none"
        ></div>
        <div
          id="Slovenia"
          class="country-container"
          style="display: none"
        ></div>
        <div id="Spain" class="country-container" style="display: none"></div>
        <div id="Sweden" class="country-container" style="display: none"></div>
        <div
          id="Switzerland"
          class="country-container"
          style="display: none"
        ></div>
        <div id="Turkey" class="country-container" style="display: none"></div>
        <div id="Ukraine" class="country-container" style="display: none"></div>
        <div
          id="UnitedKingdom"
          class="country-container"
          style="display: none"
        ></div>
        <div id="Vatican" class="country-container" style="display: none"></div>
      </div>

      <div id="map" style="height: 400px; width: 50%"></div>
    </div>

    <script>
      // Function to dynamically load the Google Maps script
      function loadGoogleMapsApi(apiKey) {
        var script = document.createElement("script");
        script.src = `https://maps.googleapis.com/maps/api/js?key=${apiKey}&callback=initMap`;
        script.async = true;
        script.defer = true;
        document.head.appendChild(script);
      }

      function toggleContinent(continent) {
        var continentButtonsDiv = document.getElementById(
          continent + "-country-buttons"
        );

        if (continent === "Europe") {
          if (
            continentButtonsDiv.style.display === "none" ||
            continentButtonsDiv.style.display === ""
          ) {
            // Show the first five buttons and hide the rest
            showFirstFiveButtons(continentButtonsDiv);
          } else {
            // Hide all buttons
            hideAllButtons(continentButtonsDiv);
          }
        } else {
          // For other continents (if any)
          continentButtonsDiv.style.display =
            continentButtonsDiv.style.display === "none" ? "block" : "none";
        }
      }

      function showFirstFiveButtons(continentButtonsDiv) {
        let europeButtons = continentButtonsDiv.children;
        // Set all buttons to display block
        for (let i = 0; i < europeButtons.length; i++) {
          europeButtons[i].style.display = "block";
        }
        continentButtonsDiv.style.display = "block";
      }

      function hideAllButtons(continentButtonsDiv) {
        let buttons = continentButtonsDiv.children;
        for (let i = 0; i < buttons.length; i++) {
          buttons[i].style.display = "none";
        }
        continentButtonsDiv.style.display = "none";
      }

      // Function to fetch bucket list for a given country from an external JSON file
      function fetchBucketList(country) {
        return fetch(`data/json/${country.toLowerCase()}.json`)
          .then((response) => {
            if (!response.ok) {
              throw new Error(`HTTP error! status: ${response.status}`);
            }
            return response.json();
          })
          .then((data) => {
            // Sort the data by score in descending order
            return data.sort((a, b) => b.score - a.score);
          })
          .catch((error) => {
            console.error("Fetching error: ", error);
            return []; // Return an empty array in case of an error
          });
      }

      function toggleCountry(country) {
        // Hide all country containers
        var containers = document.querySelectorAll(".country-container");
        containers.forEach(function (container) {
          container.style.display = "none";
        });

        var selectedContainer = document.getElementById(country);
        selectedContainer.innerHTML = ""; // Clear existing content
        selectedContainer.style.display = "flex"; // Display as flex to align buttons horizontally

        // Fetch bucket list and populate map
        fetchBucketList(country)
          .then((bucketList) => {
            bucketList.sort((a, b) => b.score - a.score);
            const numItems = bucketList.length;

            bucketList.forEach((item, index) => {
              // Create the button for each bucket list item
              let button = document.createElement("button");
              button.className = `bucket-list-button ${
                item.category.toLowerCase() || "default-category"
              }`;
              let countryImage = `assets/images/bucketlist/${country.toLowerCase()}.png`;
              button.style.backgroundImage = `url('${countryImage}')`;
              button.style.backgroundSize = `100% ${numItems * 100}%`;
              button.style.backgroundPosition = `0% ${
                index * (100 / numItems)
              }%`;
              button.textContent = item.name; // Set the text content

              // Create a container for the dropdown content
              let dropdownContent = document.createElement("div");
              dropdownContent.className = "dropdown-content";
              dropdownContent.style.display = "none"; // Initially hidden
              dropdownContent.innerHTML = `<p>${item.description}</p>`;

              // Event listener to toggle the dropdown content and zoom to location
              button.onclick = () => {
                let isVisible = dropdownContent.style.display === "flex";
                dropdownContent.style.display = isVisible ? "none" : "flex";

                // Call the function to re-center and zoom the map
                zoomToLocation(item);
              };

              selectedContainer.appendChild(button);
              selectedContainer.appendChild(dropdownContent);
            });

            plotPointsOnMap(bucketList);
          })
          .catch((error) => {
            console.error("Error fetching bucket list: ", error);
          });
      }
      function plotPointsOnMap(bucketList) {
        clearMarkers(); // Clear existing markers

        var bounds = new google.maps.LatLngBounds();
        bucketList.forEach((item) => {
          var position = new google.maps.LatLng(item.latitude, item.longitude);
          var marker = new google.maps.Marker({
            position: position,
            map: map,
            title: item.name, // Tooltip text on hover
          });

          // Creating an InfoWindow for each marker
          var infoWindow = new google.maps.InfoWindow({
            content: item.name, // Name of the bucket list activity
          });

          // Adding a click event listener to the marker
          marker.addListener("click", function () {
            infoWindow.open(map, marker);
          });

          markers.push(marker); // Add marker to the global array
          bounds.extend(position); // Extend the bounds for each marker
        });

        map.fitBounds(bounds); // Adjust the map to new bounds
      }

      // Rest of your existing code remains the same

      function clearMarkers() {
        for (let i = 0; i < markers.length; i++) {
          markers[i].setMap(null);
        }
        markers = [];
      }

      var map;
      var markers = []; // Global array to store markers

      // Initialization function for the map
      function initMap() {
        map = new google.maps.Map(document.getElementById("map"), {
          zoom: 6,
          center: { lat: 48.8566, lng: 2.3522 }, // Center on Paris
        });
      }

      // Function to fetch the API key and load the Google Maps script
      function fetchAndLoadGoogleMapsApi() {
        fetch("http://localhost:3000/api/maps-key")
          .then((response) => response.json())
          .then((data) => {
            if (data.apiKey) {
              loadGoogleMapsApi(data.apiKey);
            }
          })
          .catch((error) => console.error("Error fetching API key:", error));
      }
      // Function to zoom to a specific location
      // Function to zoom to a specific location and highlight the marker
      function zoomToLocation(item) {
        const originalZoomLevel = 5; // Original zoom level for the entire country view
        const detailedZoomLevel = 7; // Closer view zoom level

        // Zoom out to the original level
        map.setZoom(originalZoomLevel);

        // Define the position for the new location
        const position = new google.maps.LatLng(item.latitude, item.longitude);

        // Zoom in to the new location after a short delay
        setTimeout(() => {
          map.setCenter(position);
          map.setZoom(detailedZoomLevel);

          // Reset all markers to the default icon and highlight the selected one
          markers.forEach((marker) => {
            marker.setIcon(null); // Reset to default icon
            if (marker.getTitle() === item.name) {
              // Change marker icon for the selected item
              marker.setIcon(
                "http://maps.google.com/mapfiles/ms/icons/green-dot.png"
              );
            }
          });
        }, 500); // Delay in milliseconds (1000 ms = 1 second)
      }

      // Global variable for the map
      var map;
      var markers = []; // Global array to store markers

      // Call the function to start the process
      fetchAndLoadGoogleMapsApi();
    </script>
  </body>
</html>
